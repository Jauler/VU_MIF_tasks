Sorry for non-optimal code. I am not familiar with octave/matlab
